(use-modules (srfi srfi-64)
	     (htmlprag))
(test-runner-current (test-runner-simple))

(test-begin "shtml syntax")

(test-group "simple div shtml syntax"
  (test-equal "<div></div>" (shtml->html '(div)))
  (test-equal "<div>42</div>" (shtml->html '(div "42")))
  (test-equal "<div id=\"id\">42</div>" (shtml->html '(div (^ (id "id")) "42"))))

(test-group "simple custom shtml syntax"
  (test-equal "<custom></custom>" (shtml->html '(custom)))
  (test-equal "<custom>42</custom>" (shtml->html '(custom "42")))
  (test-equal "<custom id=\"id\">42</custom>" (shtml->html '(custom (^ (id "id")) "42"))))

(test-group "nested shtml syntax"
  (test-equal "<div id=\"p\"><span>Hello</span></div>" (shtml->html '(div (^ (id "p")) (span "Hello")))))

(test-end "shtml syntax")
